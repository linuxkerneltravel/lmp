/*! 
 Build based on gin-vue-admin 
 Time : 1646987814000 */
var e=(e,t,a)=>new Promise(((n,s)=>{var o=e=>{try{r(a.next(e))}catch(t){s(t)}},u=e=>{try{r(a.throw(e))}catch(t){s(t)}},r=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,u);r((a=a.apply(e,t)).next())}));import{g as t,h as a,i as n}from"../gva/gin-vue-admin-index.1646987814000.js";import{u as s}from"./gin-vue-admin-authority.16469878140002.js";import{r as o,k as u,o as r,i as l,s as d,j as i,u as c,D as h,N as m,B as y,d as p}from"./gin-vue-admin-vendor.1646987814000.js";const f={class:"clearflex"},v=y("确 定"),g={class:"custom-tree-node"},k={name:"Menus"},w=Object.assign(k,{props:{row:{default:function(){return{}},type:Object}},emits:["changeRow"],setup(k,{expose:w,emit:I}){const x=k,b=o([]),C=o([]),R=o(!1),j=o({children:"children",label:function(e){return e.meta.title}});(()=>{e(this,null,(function*(){const e=yield t();b.value=e.data.menus;const n=(yield a({authorityId:x.row.authorityId})).data.menus,s=[];n.forEach((e=>{n.some((t=>t.parentId===e.menuId))||s.push(Number(e.menuId))})),C.value=s}))})();const N=t=>e(this,null,(function*(){const e=yield s({authorityId:x.row.authorityId,AuthorityName:x.row.authorityName,parentId:x.row.parentId,defaultRouter:t.name});0===e.code&&(p({type:"success",message:"设置成功"}),I("changeRow","defaultRouter",e.data.authority.defaultRouter))})),_=()=>{R.value=!0},A=o(null),z=()=>e(this,null,(function*(){const e=A.value.getCheckedNodes(!1,!0);0===(yield n({menus:e,authorityId:x.row.authorityId})).code&&p({type:"success",message:"菜单设置成功!"})}));return w({enterAndNext:()=>{z()},needConfirm:R}),(e,t)=>{const a=u("el-button"),n=u("el-tree");return r(),l("div",null,[d("div",f,[i(a,{class:"fl-right",size:"mini",type:"primary",onClick:z},{default:c((()=>[v])),_:1})]),i(n,{ref_key:"menuTree",ref:A,data:b.value,"default-checked-keys":C.value,props:j.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"",onCheck:_},{default:c((({node:e,data:t})=>[d("span",g,[d("span",null,h(e.label),1),d("span",null,[i(a,{type:"text",size:"mini",style:m({color:k.row.defaultRouter===t.name?"#E6A23C":"#85ce61"}),disabled:!e.checked,onClick:()=>N(t)},{default:c((()=>[y(h(k.row.defaultRouter===t.name?"首页":"设为首页"),1)])),_:2},1032,["style","disabled","onClick"])])])])),_:1},8,["data","default-checked-keys","props"])])}}});export{w as default};
